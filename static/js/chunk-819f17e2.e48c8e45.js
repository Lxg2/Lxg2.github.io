(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-819f17e2"],{"557f":function(e,t,r){"use strict";r("aa8c")},aa8c:function(e,t,r){},b64bd:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container-box"},[r("el-form",{ref:"myform",staticClass:"my-form",attrs:{rules:e.rules,model:e.ruleForm,"label-width":"130px"}},[r("el-form-item",{attrs:{label:"推荐企业",prop:"title",rules:[{required:!0,message:"请输入推荐企业",trigger:"blur"}]}},[r("el-input",{attrs:{placeholder:"请输入"},model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1),r("el-form-item",{attrs:{label:"企业标签"}},[e._l(e.ruleForm.tags,(function(t){return r("el-tag",{key:t,attrs:{closable:"","disable-transitions":!1},on:{close:function(r){return e.colseitem(t)}}},[e._v(" "+e._s(t)+" ")])})),e.inputVisible?r("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:e.handleInputConfirm},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm(t)}},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}}):r("el-button",{staticClass:"button-new-tag",staticStyle:{"font-size":"13px !important"},attrs:{size:"small"},on:{click:e.showInput}},[e._v("+ 类型标签")])],2),r("el-form-item",{attrs:{label:"直播宣传片"}},[e.ruleForm.companyname?r("div",{staticStyle:{position:"relative"}},[r("video",{attrs:{width:"500",controls:"",src:e.ruleForm.companyname}}),r("i",{staticClass:"el-icon-circle-close",staticStyle:{"font-size":"30px",position:"absolute",top:"-10px",left:"505px",cursor:"pointer"},on:{click:function(t){e.ruleForm.companyname=""}}})]):r("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:e.$store.state.user.beseFile,"before-upload":e.beforeUploadvideo,"on-success":e.handleSuccessvideo,limit:1,"on-error":e.handleErrorvideo,multiple:""}},[r("i",{staticClass:"el-icon-upload"}),r("div",{staticClass:"el-upload__text"},[e._v("将视频拖到此处，或"),r("em",[e._v("点击上传")])])])],1),r("el-form-item",{attrs:{label:"企业简介"}},[e.editflag?r("Tinymce",{ref:"editor",attrs:{height:300},model:{value:e.ruleForm.content,callback:function(t){e.$set(e.ruleForm,"content",t)},expression:"ruleForm.content"}}):e._e()],1),r("el-form-item",{attrs:{label:"产业定位",prop:"categoryid"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择分类"},model:{value:e.ruleForm.categoryid,callback:function(t){e.$set(e.ruleForm,"categoryid",t)},expression:"ruleForm.categoryid"}},e._l(e.options,(function(e){return r("el-option",{key:e.id,attrs:{label:e.Categorytitle,value:e.id}})})),1)],1),r("el-form-item",{attrs:{label:"成立时间"}},[r("el-input",{attrs:{placeholder:"请输入成立时间"},model:{value:e.ruleForm.worktime,callback:function(t){e.$set(e.ruleForm,"worktime",t)},expression:"ruleForm.worktime"}})],1),r("el-form-item",{attrs:{label:"企业地址"}},[r("el-input",{attrs:{placeholder:"请输入企业地址"},model:{value:e.ruleForm.hdAddress,callback:function(t){e.$set(e.ruleForm,"hdAddress",t)},expression:"ruleForm.hdAddress"}})],1),r("el-form-item",{attrs:{label:"联系电话"}},[r("el-input",{attrs:{placeholder:"请输入联系电话"},model:{value:e.ruleForm.tellphone,callback:function(t){e.$set(e.ruleForm,"tellphone",t)},expression:"ruleForm.tellphone"}})],1),r("el-form-item",{attrs:{label:"排序ID"}},[r("el-input",{attrs:{placeholder:"ID越小越靠前"},model:{value:e.ruleForm.sortid,callback:function(t){e.$set(e.ruleForm,"sortid",t)},expression:"ruleForm.sortid"}})],1),r("el-form-item",{attrs:{label:"是否显示"}},[r("div",{staticStyle:{"margin-left":"10px"}},[r("el-switch",{attrs:{"active-text":"显示","inactive-text":"隐藏"},model:{value:e.ruleForm.isshow,callback:function(t){e.$set(e.ruleForm,"isshow",t)},expression:"ruleForm.isshow"}})],1)]),r("el-form-item",{attrs:{label:"分类封面",prop:"imgurl"}},[r("el-upload",{attrs:{action:e.$store.state.user.beseFile,"list-type":"picture-card","on-success":e.handleSuccess,"on-error":e.handleError,"before-upload":e.beforeUpload,"on-remove":e.handleRemove,"file-list":e.fileList,headers:e.upheaders,limit:1}},[r("div",{staticStyle:{display:"flex","flex-direction":"column","align-items":"center","justify-content":"center",height:"100%"},attrs:{slot:"trigger"},slot:"trigger"},[r("i",{staticClass:"el-icon-picture-outline",staticStyle:{"font-size":"80px"}}),r("i",{staticClass:"el-icon-plus",staticStyle:{"font-size":"14px","margin-top":"10px"}},[e._v("添加封面")])])])],1),r("el-form-item",[r("div",{staticClass:"but-b"},[r("el-button",{on:{click:function(t){return e.$router.go(-1)}}},[e._v("取消")]),r("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.editloading,expression:"editloading"}],attrs:{type:"primary"},on:{click:function(t){return e.submitForm("myform")}}},[e._v("发布")])],1)])],1)],1)},o=[],l=r("5530"),a=r("c7eb"),s=r("1da1"),n=(r("caad"),r("a15b"),r("a434"),r("2532"),r("2ca0"),r("b8bc")),u=r("8256"),c=r("c24f"),m=r("5f87"),d={components:{ImageUpload:n["a"],Tinymce:u["a"]},data:function(){var e=function(e,t,r){""===t||void 0===t?r(new Error("请上传封面")):r()};return{editloading:!1,editflag:!1,fileList:[],options:[{id:1,Categorytitle:"超高清视频产业"},{id:2,Categorytitle:"新能源产业"},{id:3,Categorytitle:"智能终端产业"},{id:4,Categorytitle:"半导体与集成电路产业"}],upheaders:{},imgdialogVisible:!1,validateImg:e,dialogImageUrl:"",inputVisible:!1,inputValue:"",ruleForm:{sortid:"",title:"",companyname:"",imgurl:"",categoryid:"",isshow:!0,content:"",tags:[],tellphone:"",hdAddress:"",worktime:""},rules:{categoryid:[{required:!0,message:"请输入分类标题",trigger:"blur"}]}}},created:function(){this.getinfofn()},mounted:function(){this.upheaders={Authorization:Object(m["a"])()}},methods:{beforeUploadvideo:function(e){var t=e.type.startsWith("video/");return!!t||(this.$message.error("请上传视频文件！"),!1)},handleSuccessvideo:function(e,t,r){this.ruleForm.companyname=e.filepath},handleErrorvideo:function(e,t,r){this.$message.error("视频上传失败，请重试！"+e.msg)},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick((function(t){e.$refs.saveTagInput.$refs.input.focus()}))},colseitem:function(e){this.ruleForm.tags.splice(this.ruleForm.tags.indexOf(e),1)},handleInputConfirm:function(){var e=this.inputValue;e&&(0!==this.ruleForm.tags.length?!this.ruleForm.tags.includes(e)&&this.ruleForm.tags.push(e):this.ruleForm.tags.push(e)),this.inputVisible=!1,this.inputValue=""},getinfofn:function(){var e=this;return Object(s["a"])(Object(a["a"])().mark((function t(){var r,i,o,l,s,n,u,m,d,p,f,h,g;return Object(a["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["e"])({id:e.$route.query.id});case 2:r=t.sent,i=r.datalist,o=i.Content,l=i.Companyname,s=i.Title,n=i.Sortid,u=i.Categoryid,m=i.Isshow,d=i.Imgurl,p=i.Tags,f=i.Tellphone,h=i.HdAddress,g=i.Worktime,e.$nextTick((function(){e.ruleForm.content=o})),e.editflag=!0,e.ruleForm.companyname=l,e.ruleForm.categoryid=u,p&&0!==p.length&&(e.ruleForm.tags=p.split(",")),e.ruleForm.tellphone=f,e.ruleForm.hdAddress=h,e.ruleForm.worktime=g,e.ruleForm.title=s,e.ruleForm.sortid=n,e.ruleForm.isshow=!!m,e.ruleForm.imgurl=d,d&&(e.fileList=[{url:d}]);case 28:case"end":return t.stop()}}),t)})))()},handleAvatarSuccess:function(e,t){this.ruleForm.imgurl=e.filepath,this.fileList=[{url:imgurl}]},beforeUpload:function(e){var t="image/jpeg"===e.type,r="image/png"===e.type,i=e.size/1024/1024<10;return t||r||this.$message.error("上传图片只能是 JPG/PNG 格式!"),i||this.$message.error("上传图片大小不能超过 10MB!"),t||r&&i},handleSuccess:function(e){this.ruleForm.imgurl=e.filepath},handleError:function(e){this.$message.error(e.msg)},handleRemove:function(){this.ruleForm.imgurl="",this.fileList=[]},getLatLng:function(){var e=this,t=new TMap.service.Geocoder({});t.getLocation({address:this.ruleForm.hdAddress}).then(function(){var t=Object(s["a"])(Object(a["a"])().mark((function t(r){var i,o,s,n;return Object(a["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0!==r.status||"Success"!==r.message){t.next=12;break}return e.ruleForm.hdLat=r.result.location.lat,e.ruleForm.hdLng=r.result.location.lng,i=e.ruleForm,o=i.isshow,s=i.tags,s&&0!==s.length&&(s=s.join(",")),t.next=7,Object(c["n"])(Object(l["a"])(Object(l["a"])({},e.ruleForm),{},{tags:s,isshow:+o,channelname:e.$route.meta.channelname,id:e.$route.query.id}));case 7:n=t.sent,200===n.status&&(e.$message.success(n.msg),e.$router.go(-1)),e.editloading=!1,t.next=14;break;case 12:e.btnloading=!1,e.$message.error("地址解析失败，请重新输入地址");case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.btnloading=!1,e.$message.error("地址解析错误，请检查后再试")}))},submitForm:function(e){var t=this;return Object(s["a"])(Object(a["a"])().mark((function r(){return Object(a["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.$refs[e].validate(function(){var e=Object(s["a"])(Object(a["a"])().mark((function e(r){return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:r&&(t.editloading=!0,t.getLatLng());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return r.stop()}}),r)})))()}}},p=d,f=(r("557f"),r("2877")),h=Object(f["a"])(p,i,o,!1,null,"f7692f34",null);t["default"]=h.exports}}]);