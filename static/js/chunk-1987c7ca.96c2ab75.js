(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1987c7ca"],{"11bc":function(e,t,r){"use strict";r.r(t);var l=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container-box"},[r("el-form",{ref:"myform",staticClass:"my-form",attrs:{rules:e.rules,model:e.ruleForm,"label-width":"200px"}},[r("el-form-item",{attrs:{label:"空间名称",prop:"title"}},[r("el-input",{attrs:{placeholder:"请输入空间名称"},model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1),r("el-form-item",{attrs:{label:"标签展示"}},[e._l(e.ruleForm.tags,(function(t){return r("el-tag",{key:t,attrs:{closable:"","disable-transitions":!1},on:{close:function(r){return e.colseitem(t)}}},[e._v(" "+e._s(t)+" ")])})),e.inputVisible?r("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:e.handleInputConfirm},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm(t)}},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}}):r("el-button",{staticClass:"button-new-tag",staticStyle:{"font-size":"13px !important"},attrs:{size:"small"},on:{click:e.showInput}},[e._v("+ 类型标签")])],2),r("el-form-item",{attrs:{label:"所属分类",prop:"categoryid"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择分类"},model:{value:e.ruleForm.categoryid,callback:function(t){e.$set(e.ruleForm,"categoryid",t)},expression:"ruleForm.categoryid"}},e._l(e.options,(function(e){return r("el-option",{key:e.id,attrs:{label:e.Categorytitle,value:e.id}})})),1)],1),r("el-form-item",{attrs:{label:"区域"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择区域"},model:{value:e.ruleForm.areaid,callback:function(t){e.$set(e.ruleForm,"areaid",t)},expression:"ruleForm.areaid"}},e._l(e.options2,(function(e){return r("el-option",{key:e.Categorytitle,attrs:{label:e.Categorytitle,value:e.Categorytitle}})})),1)],1),r("el-form-item",{attrs:{label:"楼层/栋"}},[r("el-input",{attrs:{placeholder:"例如C栋3层"},model:{value:e.ruleForm.floor,callback:function(t){e.$set(e.ruleForm,"floor",t)},expression:"ruleForm.floor"}})],1),r("el-form-item",{attrs:{label:"租金(元/m²)(暂无请填0)"}},[r("el-input",{attrs:{type:"number",placeholder:"请输入租金"},model:{value:e.ruleForm.rent,callback:function(t){e.$set(e.ruleForm,"rent",t)},expression:"ruleForm.rent"}})],1),r("el-form-item",{attrs:{label:"面积(单位:m²)"}},[r("el-input",{attrs:{type:"number",placeholder:"请输入面积"},model:{value:e.ruleForm.area,callback:function(t){e.$set(e.ruleForm,"area",t)},expression:"ruleForm.area"}})],1),r("el-form-item",{attrs:{label:"电梯类型"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择电梯"},model:{value:e.ruleForm.elevatortype,callback:function(t){e.$set(e.ruleForm,"elevatortype",t)},expression:"ruleForm.elevatortype"}},e._l(e.options3,(function(e){return r("el-option",{key:e.Categorytitle,attrs:{label:e.Categorytitle,value:e.Categorytitle}})})),1)],1),r("el-form-item",{attrs:{label:"招商定位"}},[r("el-input",{attrs:{placeholder:"请输入招商定位"},model:{value:e.ruleForm.companyname,callback:function(t){e.$set(e.ruleForm,"companyname",t)},expression:"ruleForm.companyname"}})],1),r("el-form-item",{attrs:{label:"交付标准"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择交付标准"},model:{value:e.ruleForm.deliverystandards,callback:function(t){e.$set(e.ruleForm,"deliverystandards",t)},expression:"ruleForm.deliverystandards"}},e._l(e.options4,(function(e){return r("el-option",{key:e.Categorytitle,attrs:{label:e.Categorytitle,value:e.Categorytitle}})})),1)],1),r("el-form-item",{attrs:{label:"建成年份"}},[r("el-input",{attrs:{type:"number",placeholder:"请输入建成年份"},model:{value:e.ruleForm.yearbuilt,callback:function(t){e.$set(e.ruleForm,"yearbuilt",t)},expression:"ruleForm.yearbuilt"}})],1),r("el-form-item",{attrs:{label:"详细地址"}},[r("el-input",{attrs:{placeholder:"请输入详细地址"},model:{value:e.ruleForm.hdAddress,callback:function(t){e.$set(e.ruleForm,"hdAddress",t)},expression:"ruleForm.hdAddress"}})],1),r("el-form-item",{attrs:{label:"负责人"}},[r("el-input",{attrs:{placeholder:"请输入负责人"},model:{value:e.ruleForm.floorheight,callback:function(t){e.$set(e.ruleForm,"floorheight",t)},expression:"ruleForm.floorheight"}})],1),r("el-form-item",{attrs:{label:"联系电话"}},[r("el-input",{attrs:{type:"number",placeholder:"请输入联系方式"},model:{value:e.ruleForm.communityusermobile,callback:function(t){e.$set(e.ruleForm,"communityusermobile",t)},expression:"ruleForm.communityusermobile"}})],1),r("el-form-item",{attrs:{label:"运营商"}},[r("el-input",{attrs:{placeholder:"请输入运营商"},model:{value:e.ruleForm.rentingfloors,callback:function(t){e.$set(e.ruleForm,"rentingfloors",t)},expression:"ruleForm.rentingfloors"}})],1),r("el-form-item",{attrs:{label:"空间简介",prop:"content"}},[e.editflag?r("Tinymce",{ref:"editor",attrs:{height:250},model:{value:e.ruleForm.remarks,callback:function(t){e.$set(e.ruleForm,"remarks",t)},expression:"ruleForm.remarks"}}):e._e()],1),r("el-form-item",{attrs:{label:"配套设施",prop:"content"}},[e.editflag?r("Tinymce",{ref:"editor",attrs:{height:250},model:{value:e.ruleForm.content,callback:function(t){e.$set(e.ruleForm,"content",t)},expression:"ruleForm.content"}}):e._e()],1),r("el-form-item",{attrs:{label:"置顶/热门"}},[r("div",{staticStyle:{"margin-left":"10px"}},[r("el-checkbox-group",{model:{value:e.ruleForm.hotstr,callback:function(t){e.$set(e.ruleForm,"hotstr",t)},expression:"ruleForm.hotstr"}},[r("el-checkbox",{attrs:{label:"置顶",value:1}}),r("el-checkbox",{attrs:{label:"热门",value:2}})],1)],1)]),r("el-form-item",{attrs:{label:"排序ID"}},[r("el-input",{attrs:{placeholder:"ID越小越靠前"},model:{value:e.ruleForm.sortid,callback:function(t){e.$set(e.ruleForm,"sortid",t)},expression:"ruleForm.sortid"}})],1),r("el-form-item",{attrs:{label:"是否显示"}},[r("div",{staticStyle:{"margin-left":"10px"}},[r("el-switch",{attrs:{"active-text":"显示","inactive-text":"隐藏"},model:{value:e.ruleForm.isshow,callback:function(t){e.$set(e.ruleForm,"isshow",t)},expression:"ruleForm.isshow"}})],1)]),r("el-form-item",{attrs:{label:"封面",prop:"filelist"}},[r("el-upload",{attrs:{action:e.$store.state.user.beseFile,"list-type":"picture-card","on-success":e.handleSuccess,"on-error":e.handleError,"before-upload":e.beforeUpload,"on-remove":e.handleRemove,"file-list":e.fileList,headers:e.upheaders,multiple:""}},[r("div",{staticStyle:{display:"flex","flex-direction":"column","align-items":"center","justify-content":"center",height:"100%"},attrs:{slot:"trigger"},slot:"trigger"},[r("i",{staticClass:"el-icon-picture-outline",staticStyle:{"font-size":"80px"}}),r("i",{staticClass:"el-icon-plus",staticStyle:{"font-size":"14px","margin-top":"10px"}},[e._v("添加封面")])])])],1),r("el-form-item",[r("div",{staticClass:"but-b"},[r("el-button",{on:{click:function(t){return e.$router.go(-1)}}},[e._v("取消")]),r("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.editloadingflag,expression:"editloadingflag"}],attrs:{type:"primary"},on:{click:function(t){return e.submitForm("myform")}}},[e._v("发布")])],1)])],1)],1)},o=[],a=r("5530"),i=r("c7eb"),s=r("1da1"),n=(r("c740"),r("caad"),r("a15b"),r("d81d"),r("a434"),r("d3b7"),r("2532"),r("159b"),r("b8bc")),u=r("8256"),c=r("c24f"),m={components:{ImageUpload:n["a"],Tinymce:u["a"]},data:function(){var e=function(e,t,r){""===t||void 0===t?r(new Error("请上传封面")):r()};return{editflag:!1,editloadingflag:!1,options:[{id:0,Categorytitle:"工业"},{id:1,Categorytitle:"办公"},{id:2,Categorytitle:"商业"}],options2:[{Categorytitle:"石龙社区"},{Categorytitle:"水田社区"},{Categorytitle:"官田社区"},{Categorytitle:"上屋社区"},{Categorytitle:"龙腾社区"},{Categorytitle:"浪心社区"},{Categorytitle:"宝源社区"},{Categorytitle:"罗租社区"},{Categorytitle:"塘头社区"},{Categorytitle:"应人石社区"}],options3:[{Categorytitle:"不限"},{id:0,Categorytitle:"客梯"},{id:1,Categorytitle:"货梯"}],options4:[{Categorytitle:"不限"},{id:0,Categorytitle:"毛坯"},{id:1,Categorytitle:"精装"}],fileList:[],upheaders:{},imgdialogVisible:!1,validateImg:e,dialogImageUrl:"",inputVisible:!1,inputValue:"",ruleForm:{title:"",tags:[],categoryid:"",areaid:"",floor:"",rent:"",area:"",floorheight:"",elevatortype:"",companyname:"",rentingfloors:"",deliverystandards:"",yearbuilt:"",communityusermobile:"",remarks:"",isshow:!0,hotstr:[],content:"",sortid:"",filelist:[],hdAddress:""},rules:{title:[{required:!0,message:"请输入标题",trigger:"blur"}],categoryid:[{required:!0,message:"请选择分类",trigger:"blur"}],content:[{required:!0,message:"请填写内容",trigger:"change"}],filelist:[{required:!0,trigger:"change",validator:e}]}}},created:function(){var e=this;this.getclasslist(),Object(c["e"])({id:this.$route.query.id}).then((function(t){var r=t.datalist,l=r.Title,o=r.Content,a=r.Hotstr,i=r.Categoryid,s=r.Sortid,n=r.Isshow,u=r.Tags,c=r.Areaid,m=r.Floor,d=r.Rent,p=r.Area,f=r.Floorheight,g=r.Elevatortype,h=r.Companyname,b=r.Rentingfloors,y=r.Deliverystandards,F=r.Yearbuilt,v=r.Communityusermobile,k=r.Remarks,x=r.Fileslist,C=r.HdAddress;e.ruleForm.title=l,e.ruleForm.tags=u?u.split(","):[],e.ruleForm.areaid=c,e.ruleForm.floor=m,e.ruleForm.rent=d,e.ruleForm.area=p,e.ruleForm.floorheight=f,e.ruleForm.elevatortype=g,e.ruleForm.companyname=h,e.ruleForm.rentingfloors=b,e.ruleForm.deliverystandards=y,e.ruleForm.yearbuilt=F,e.ruleForm.communityusermobile=v;var w=[];x.forEach((function(e){return w.push({uid:e,url:e})})),e.ruleForm.filelist=w,e.fileList=w,e.ruleForm.hdAddress=C,e.ruleForm.hotstr=a.split(","),e.ruleForm.categoryid=i,e.editflag=!0,e.ruleForm.sortid=s,e.ruleForm.isshow=!!n,e.$nextTick((function(){e.ruleForm.content=o,e.ruleForm.remarks=k}))}))},mounted:function(){},methods:{getclasslist:function(){var e=this;return Object(s["a"])(Object(i["a"])().mark((function t(){var r;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["j"])({channelname:e.$route.meta.channelname});case 2:r=t.sent,e.options=r.datalist;case 4:case"end":return t.stop()}}),t)})))()},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick((function(t){e.$refs.saveTagInput.$refs.input.focus()}))},colseitem:function(e){this.ruleForm.tags.splice(this.ruleForm.tags.indexOf(e),1)},handleInputConfirm:function(){var e=this.inputValue;e&&(0!==this.ruleForm.tags.length?!this.ruleForm.tags.includes(e)&&this.ruleForm.tags.push(e):this.ruleForm.tags.push(e)),this.inputVisible=!1,this.inputValue=""},beforeUpload:function(e){var t="image/jpeg"===e.type,r="image/png"===e.type,l=e.size/1024/1024<10;return t||r||this.$message.error("上传图片只能是 JPG/PNG 格式!"),l||this.$message.error("上传图片大小不能超过 10MB!"),t||r&&l},handleSuccess:function(e,t,r){var l=this;200===e.status&&r.every((function(e){return"success"==e.status}))&&r.map((function(e){e.response&&l.ruleForm.filelist.push({url:e.response.filepath,uid:e.uid})}))},handleError:function(e){this.$message.error(e.msg)},handleRemove:function(e){var t=this.ruleForm.filelist.findIndex((function(t){return t.uid===e.uid}));this.ruleForm.filelist.splice(t,1)},getselectlist:function(){var e=this;return Object(s["a"])(Object(i["a"])().mark((function t(){var r;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["j"])({channelname:e.$route.meta.channelname});case 2:r=t.sent,e.options=r.datalist;case 4:case"end":return t.stop()}}),t)})))()},getLatLng:function(){var e=this,t=new TMap.service.Geocoder({});t.getLocation({address:this.ruleForm.hdAddress}).then(function(){var t=Object(s["a"])(Object(i["a"])().mark((function t(r){var l,o,s,n,u,m;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(console.log(r,"------"),0!==r.status||"Success"!==r.message){t.next=15;break}return e.ruleForm.hdLat=r.result.location.lat,e.ruleForm.hdLng=r.result.location.lng,l=e.ruleForm,o=l.hotstr,s=l.isshow,n=l.filelist,u=l.tags,n=n.map((function(e){return e.url})).join(","),u=u.join(","),e.ruleForm.hotstr=o.join(","),t.next=10,Object(c["n"])(Object(a["a"])(Object(a["a"])({},e.ruleForm),{},{filelist:n,tags:u,id:e.$route.query.id,channelname:e.$route.meta.channelname,isshow:+s}));case 10:m=t.sent,200==m.status&&(e.$message.success(m.msg),e.$router.go(-1)),e.editloadingflag=!1,t.next=17;break;case 15:e.editloadingflag=!1,e.$message.error("地址解析失败，请重新输入地址");case 17:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.editloadingflag=!1,e.$message.error("网络错误，请检查后再试")}))},submitForm:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(s["a"])(Object(i["a"])().mark((function e(r){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:r&&(t.editloadingflag=!0,t.getLatLng());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}},d=m,p=(r("3eb7"),r("2877")),f=Object(p["a"])(d,l,o,!1,null,"a755427a",null);t["default"]=f.exports},"3eb7":function(e,t,r){"use strict";r("f1fd")},f1fd:function(e,t,r){}}]);